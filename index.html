<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Negocios RD â€“ v17 (OSM + Overpass, CORS fallbacks)</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <style>
    :root{ --bg:#f7fafc; --card:#ffffff; --muted:#64748b; --text:#0b1220; --border:#e5e9f2; --chip:#eef2f7; --accent:#10b981; }
    *{box-sizing:border-box}
    body{margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:linear-gradient(180deg,#f6f8fc 0%, #eef2f7 100%); color:var(--text);}
    .container{max-width:1200px; margin:0 auto; padding:16px;}
    .title{display:flex; align-items:center; gap:10px; margin:0 0 10px; }
    .badge{background:var(--chip); color:#475569; border:1px solid #e2e8f0; padding:3px 8px; border-radius:999px; font-size:12px;}
    .card{background:var(--card); border:1px solid var(--border); border-radius:16px; padding:12px; box-shadow:0 6px 16px rgba(15,23,42,.06);}
    .muted{color:var(--muted); font-size:12px;}
    .grid{display:grid; gap:8px;}
    .grid-4{grid-template-columns: repeat(4, minmax(0, 1fr));}
    select,input[type="text"],button{width:100%; padding:10px; border-radius:12px; border:1px solid #d7dde8; background:#fff; color:#0b1220; outline:none;}
    button{cursor:pointer; font-weight:600;}
    .btn{border:1px solid #dbe1ea; background:#ffffff;}
    .btn-primary{background: linear-gradient(135deg, var(--accent), #14b8a6); border:0; color:#ffffff;}
    #map{width:100%; height:64vh; border-radius:14px; border:1px solid #dbe1ea; background:#eef2f7;}
    .table-wrap{max-height:60vh; overflow:auto; border-radius:12px; border:1px solid var(--border);}
    table{width:100%; border-collapse:collapse; font-size:12px;}
    th, td{padding:8px 10px; border-bottom:1px solid #eef2f7; text-align:left; vertical-align:top;}
    th{position:sticky; top:0; background:#f4f7fb; color:#64748b; z-index:1;}
    .errbar,.okbar{position:fixed; left:8px; right:8px; bottom:8px; padding:8px 10px; border-radius:12px; display:none;}
    .errbar{background:#fde8e8; border:1px solid #f8b4b4; color:#7f1d1d;}
    .okbar{background:#ecfdf5; border:1px solid #a7f3d0; color:#065f46;}
    .progress{height:10px; background:#eef2f7; border-radius:999px; overflow:hidden; border:1px solid #e5e9f2;}
    .progress > div{height:100%; width:0%; background:linear-gradient(90deg,#10b981,#14b8a6); transition:width .25s;}
    textarea{width:100%; min-height:120px; font-family: ui-monospace, Menlo, Consolas, monospace; font-size:12px; background:#0b1220; color:#e8eef9; border-radius:10px; border:1px solid #1f2937; padding:8px; display:none;}
  </style>
</head>
<body>
  <div class="container">
    <div class="title">
      <h2 style="margin:0">Negocios RD</h2>
      <span class="badge">OSM + Overpass (con fallbacks CORS)</span>
      <span class="badge">100% gratis Â· GitHub Pages</span>
    </div>

    <div class="card">
      <div class="grid grid-4">
        <div>
          <label class="muted">Tipo de negocio (buscador)</label>
          <input id="qTipo" type="text" placeholder="Ej.: ferreterÃ­a, papelerÃ­a, farmacia, colegios..." />
        </div>
        <div>
          <label class="muted">Provincia</label>
          <select id="selProv"></select>
        </div>
        <div>
          <label class="muted">Municipio (opcional)</label>
          <select id="selMuni"><option value="">(todos)</option></select>
        </div>
        <div style="display:flex; align-items:end; gap:8px;">
          <button id="btnBuscar" class="btn btn-primary" style="flex:1">ðŸ”Ž Buscar</button>
          <button id="btnCSV" class="btn" style="flex:1">â¬‡ CSV</button>
        </div>
      </div>
      <div class="row" style="display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-top:8px;">
        <div class="progress" style="flex:1; min-width:160px;"><div id="pbar"></div></div>
        <span id="status" class="muted">Listo</span>
        <label class="switch"><input type="checkbox" id="cbCluster" checked> Clustering</label>
        <label class="switch"><input type="checkbox" id="cbRapido"> Modo rÃ¡pido</label>
        <button id="btnVerQL" class="btn">ðŸ‘€ Ver consulta</button>
        <button id="btnDemo" class="btn">âœ¨ Demo</button>
      </div>
      <div class="muted" style="margin-top:6px;">Si un mirror de Overpass falla, la app intenta otros y como Ãºltimo recurso usa <code>r.jina.ai</code> (proxy de solo lectura).</div>
      <textarea id="ql"></textarea>
    </div>

    <div class="grid" style="grid-template-columns: 1.2fr .8fr; gap:16px; margin-top:10px;">
      <div class="card"><div id="map"></div></div>
      <div class="card">
        <div class="toolbar" style="display:flex; justify-content:space-between; margin-bottom:6px;">
          <div class="badge">Resultados: <span id="statCount">0</span></div>
          <div class="badge">Fuente: OpenStreetMap (cobertura variable)</div>
        </div>
        <div class="table-wrap">
          <table id="tbl">
            <thead><tr><th>Nombre</th><th>Tipo</th><th>DirecciÃ³n</th><th>TelÃ©fono</th><th>Web</th><th>Lat</th><th>Lon</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <div id="err" class="errbar"></div><div id="ok" class="okbar"></div>

<script>
const PROVINCIAS = ["Azua","Bahoruco","Barahona","DajabÃ³n","Distrito Nacional","Duarte","El Seibo","ElÃ­as PiÃ±a","Espaillat","Hato Mayor","Hermanas Mirabal","Independencia","La Altagracia","La Romana","La Vega","MarÃ­a Trinidad SÃ¡nchez","MonseÃ±or Nouel","Monte Cristi","Monte Plata","Pedernales","Peravia","Puerto Plata","SamanÃ¡","San CristÃ³bal","San JosÃ© de Ocoa","San Juan","San Pedro de MacorÃ­s","SÃ¡nchez RamÃ­rez","Santiago","Santiago RodrÃ­guez","Santo Domingo","Valverde"];
const MUNICIPIOS = {"Azua":["Azua de Compostela","EstebanÃ­a","Guayabal","Las Charcas","Las Yayas de Viajama","Padre Las Casas","Peralta","Pueblo Viejo","Sabana Yegua","TÃ¡bara Arriba"],"Bahoruco":["Neiba","GalvÃ¡n","Los RÃ­os","Tamayo","Villa Jaragua"],"Barahona":["Barahona","Cabral","El PeÃ±Ã³n","Enriquillo","FundaciÃ³n","Jaquimeyes","La CiÃ©naga","Las Salinas","ParaÃ­so","Polo","Vicente Noble"],"DajabÃ³n":["DajabÃ³n","El Pino","Loma de Cabrera","Partido","RestauraciÃ³n"],"Distrito Nacional":["Santo Domingo de GuzmÃ¡n"],"Duarte":["San Francisco de MacorÃ­s","Arenoso","Castillo","Eugenio MarÃ­a de Hostos","Las GuÃ¡ranas","Pimentel","Villa Riva"],"El Seibo":["Santa Cruz de El Seibo","Miches"],"ElÃ­as PiÃ±a":["Comendador","BÃ¡nica","El Llano","Hondo Valle","Juan Santiago","Pedro Santana"],"Espaillat":["Moca","Cayetano GermosÃ©n","Gaspar HernÃ¡ndez","Jamao al Norte"],"Hato Mayor":["Hato Mayor del Rey","El Valle","Sabana de la Mar"],"Hermanas Mirabal":["Salcedo","Tenares","Villa Tapia"],"Independencia":["JimanÃ­","CristÃ³bal","DuvergÃ©","La Descubierta","Mella","Postrer RÃ­o"],"La Altagracia":["SalvaleÃ³n de HigÃ¼ey","San Rafael del Yuma"],"La Romana":["La Romana","Guaymate","Villa Hermosa"],"La Vega":["La Vega","Constanza","Jarabacoa","Jima Abajo"],"MarÃ­a Trinidad SÃ¡nchez":["Nagua","Cabrera","El Factor","RÃ­o San Juan"],"MonseÃ±or Nouel":["Bonao","MaimÃ³n","Piedra Blanca"],"Monte Cristi":["San Fernando de Monte Cristi","CastaÃ±uelas","GuayubÃ­n","Las Matas de Santa Cruz","Pepillo Salcedo","Villa VÃ¡squez"],"Monte Plata":["Monte Plata","Bayaguana","Peralvillo","Sabana Grande de BoyÃ¡","YamasÃ¡"],"Pedernales":["Pedernales","Oviedo"],"Peravia":["BanÃ­","Nizao"],"Puerto Plata":["San Felipe de Puerto Plata","Altamira","Guananico","Imbert","Los Hidalgos","LuperÃ³n","SosÃºa","Villa Isabela","Montellano"],"SamanÃ¡":["Santa BÃ¡rbara de SamanÃ¡","SÃ¡nchez","Las Terrenas"],"San CristÃ³bal":["San CristÃ³bal","Bajos de Haina","Cambita Garabitos","Los Cacaos","Sabana Grande de Palenque","San Gregorio de Nigua","Villa Altagracia","Yaguate"],"San JosÃ© de Ocoa":["San JosÃ© de Ocoa","Sabana Larga","Rancho Arriba"],"San Juan":["San Juan de la Maguana","BohechÃ­o","El Cercado","Juan de Herrera","Las Matas de FarfÃ¡n","Vallejuelo"],"San Pedro de MacorÃ­s":["San Pedro de MacorÃ­s","Consuelo","Guayacanes","Quisqueya","RamÃ³n Santana","San JosÃ© de los Llanos"],"SÃ¡nchez RamÃ­rez":["CotuÃ­","Cevicos","Fantino","La Mata"],"Santiago":["Santiago de los Caballeros","BisonÃ³ (Navarrete)","JÃ¡nico","Licey al Medio","PuÃ±al","Sabana Iglesia","San JosÃ© de las Matas","Tamboril","Villa GonzÃ¡lez"],"Santiago RodrÃ­guez":["San Ignacio de Sabaneta","Los AlmÃ¡cigos","MonciÃ³n"],"Santo Domingo":["Santo Domingo Este","Santo Domingo Norte","Santo Domingo Oeste","Boca Chica","San Antonio de Guerra","Los Alcarrizos","Pedro Brand"],"Valverde":["Mao","Esperanza","Laguna Salada"]};

const OVERPASS = [
  "https://lz4.overpass-api.de/api/interpreter",
  "https://z.overpass-api.de/api/interpreter",
  "https://overpass-api.de/api/interpreter",
  "https://overpass.kumi.systems/api/interpreter",
  "https://overpass.openstreetmap.fr/api/interpreter"
];
const CORS_WRAPPERS = [
  "https://r.jina.ai/http://",
  "https://r.jina.ai/https://"
];

const KEYMAP = {'colegio':[{k:'amenity',v:'school'}],'colegios':[{'k':'amenity','v':'school'}],'escuela':[{'k':'amenity','v':'school'}],'universidad':[{'k':'amenity','v':'university'}],'hospital':[{'k':'amenity','v':'hospital'}],'clinica':[{'k':'amenity','v':'clinic'}],'clÃ­nica':[{'k':'amenity','v':'clinic'}],'farmacia':[{'k':'amenity','v':'pharmacy'},{'k':'shop','v':'chemist'}],'ferreteria':[{'k':'shop','v':'hardware'},{'k':'shop','v':'doityourself'},{'k':'shop','v':'construction_supplies'}],'ferreterÃ­a':[{'k':'shop','v':'hardware'},{'k':'shop','v':'doityourself'},{'k':'shop','v':'construction_supplies'}],'papeleria':[{'k':'shop','v':'stationery'},{'k':'shop','v':'office_supplies'}],'papelerÃ­a':[{'k':'shop','v':'stationery'},{'k':'shop','v':'office_supplies'}],'supermercado':[{'k':'shop','v':'supermarket'}],'colmado':[{'k':'shop','v':'convenience'}],'taller':[{'k':'shop','v':'car_repair'}],'repuestos':[{'k':'shop','v':'car_parts'}],'zapateria':[{'k':'shop','v':'shoes'}],'zapaterÃ­a':[{'k':'shop','v':'shoes'}],'muebles':[{'k':'shop','v':'furniture'}],'banco':[{'k':'amenity','v':'bank'}],'hotel':[{'k':'tourism','v':'hotel'}],'veterinaria':[{'k':'amenity','v':'veterinary'}]};

const STATE = { map:null, cluster:null, markers:[], feats:[], lastQL:'', lastServer:'' };

function showErr(m){const e=document.getElementById('err'); e.textContent=m; e.style.display='block'; setTimeout(()=>e.style.display='none',6000);}
function showOk(m){const e=document.getElementById('ok'); e.textContent=m; e.style.display='block'; setTimeout(()=>e.style.display='none',2200);}
function setStatus(t,p=null){document.getElementById('status').textContent=t; if(p!=null) document.getElementById('pbar').style.width=Math.min(100,Math.max(0,p))+'%';}
function setBusy(b){document.querySelectorAll('button,select,input').forEach(el=>el.disabled=!!b);}
function norm(s){return (s||'').toString().trim().toLowerCase();}
function strip(s){return (s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'');}
function esc(s){return (s||'').replace(/[.*+?^${}()|[\]\\]/g,'\\$&');}

function initMap(){ if(STATE.map) return; const RD=[18.735693,-70.162651]; STATE.map=L.map('map').setView(RD,8); L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19,attribution:'&copy; OpenStreetMap'}).addTo(STATE.map); }
function ensureCluster(){ if(!STATE.cluster){ STATE.cluster=L.markerClusterGroup({showCoverageOnHover:false,maxClusterRadius:50}); STATE.map.addLayer(STATE.cluster);} }
function clearMarkers(){ if(STATE.cluster){STATE.cluster.clearLayers();} (STATE.markers||[]).forEach(m=>{try{STATE.map.removeLayer(m);}catch{}}); STATE.markers=[]; }
function addMarker(lat,lon,props){ const m=L.marker([lat,lon]); const web=props.website?`<div>Web: <a href="${props.website}" target="_blank" rel="noopener">${props.website}</a></div>`:''; const tel=props.phone?`<div>Tel: ${props.phone}</div>`:''; m.bindPopup(`<strong>${props.name||'(sin nombre)'}</strong><div class="muted">${props.tipo||''}</div><div>${props.address||''}</div>${tel}${web}`); STATE.markers.push(m); if(document.getElementById('cbCluster').checked){ensureCluster(); STATE.cluster.addLayer(m);} else m.addTo(STATE.map); }

function qlHeader(){ return "[out:json][timeout:30];"; }
function qlAreaByName(name){
  const rx = esc(name);
  return `${qlHeader()}
area["ISO3166-1"="DO"]->.country;
rel(area.country)["boundary"="administrative"]["name"~"^${rx}$", i];
out ids bb;`;
}
function qlByBBoxTags(tags, bbox, rapido){
  const s=bbox.minlat, w=bbox.minlon, n=bbox.maxlat, e=bbox.maxlon;
  const lim = rapido? ' 300' : '';
  const parts = tags.map(t => `node["${t.k}"="${t.v}"](${s},${w},${n},${e}); way["${t.k}"="${t.v}"](${s},${w},${n},${e}); relation["${t.k}"="${t.v}"](${s},${w},${n},${e});`).join('\n');
  return `${qlHeader()}(${parts})out center${lim};`;
}
function qlByBBoxName(q, bbox, rapido){
  const s=bbox.minlat, w=bbox.minlon, n=bbox.maxlat, e=bbox.maxlon;
  const lim = rapido? ' 300' : '';
  const rx=esc(q);
  return `${qlHeader()}(
    node["name"~"${rx}", i](${s},${w},${n},${e});
    way["name"~"${rx}", i](${s},${w},${n},${e});
    relation["name"~"${rx}", i](${s},${w},${n},${e});
    node["shop"~"${rx}", i](${s},${w},${n},${e});
    way["shop"~"${rx}", i](${s},${w},${n},${e});
    relation["shop"~"${rx}", i](${s},${w},${n},${e});
    node["amenity"~"${rx}", i](${s},${w},${n},${e});
    way["amenity"~"${rx}", i](${s},${w},${n},${e});
    relation["amenity"~"${rx}", i](${s},${w},${n},${e});
  )out center${lim};`;
}
function expandBBox(b, padDeg=0.2){
  return {minlat:b.minlat-padDeg, minlon:b.minlon-padDeg, maxlat:b.maxlat+padDeg, maxlon:b.maxlon+padDeg};
}
function useableCount(json){
  let c=0; const els=(json&&json.elements)||[];
  for(const el of els){ const lat = el.lat || (el.center && el.center.lat); const lon = el.lon || (el.center && el.center.lon); if(lat!=null && lon!=null) c++; }
  return c;
}
function pushResults(json){
  const els=(json&&json.elements)||[];
  for(const el of els){
    const lat = el.lat || (el.center && el.center.lat);
    const lon = el.lon || (el.center && el.center.lon);
    if(lat==null || lon==null) continue;
    const t = el.tags||{};
    STATE.feats.push({name:t.name||'', tipo:t.shop||t.amenity||'', address:[t['addr:street'],t['addr:housenumber']].filter(Boolean).join(' ')||t['addr:full']||'', phone:t['phone']||t['contact:phone']||'', website:t['website']||t['contact:website']||'', lat:+lat, lon:+lon});
  }
}

async function getJSON(url, timeoutMs=35000){
  const ctrl = new AbortController();
  const to = setTimeout(()=>ctrl.abort(), timeoutMs);
  const r = await fetch(url, {headers:{'Accept':'application/json'}, signal: ctrl.signal});
  clearTimeout(to);
  if(!r.ok) throw new Error('HTTP '+r.status);
  return r.json();
}

async function overpassTryAll(ql){
  const short = '?data='+encodeURIComponent(ql);
  const urlsPrimary = OVERPASS.map(b=> b + short);
  const urlsWrapped = [];
  for(const wrap of CORS_WRAPPERS){
    for(const base of OVERPASS){
      const clean = base.replace(/^https?:\/\//,'');
      urlsWrapped.push(wrap + clean + short);
    }
  }
  const all = urlsPrimary.concat(urlsWrapped);
  let lastErr=null;
  for(const u of all){
    try{
      const data = await getJSON(u);
      STATE.lastServer = u;
      return data;
    }catch(e){ lastErr=e; }
  }
  throw lastErr || new Error('Overpass unreachable');
}

async function fetchBBoxByName(name){
  const q = qlAreaByName(name);
  STATE.lastQL = q; document.getElementById('ql').value = q;
  const data = await overpassTryAll(q);
  if(data && data.bounds) return data.bounds;
  if(data && data.elements && data.elements[0] && data.elements[0].bounds) return data.elements[0].bounds;
  throw new Error('Sin bbox para '+name);
}

async function buscar(){
  initMap();
  const tipo = document.getElementById('qTipo').value.trim();
  const prov = document.getElementById('selProv').value;
  const muni = document.getElementById('selMuni').value || '';
  const rapido = document.getElementById('cbRapido').checked;
  if(!tipo) return showErr('Escriba el tipo de negocio.');
  if(!prov) return showErr('Seleccione una provincia.');

  setBusy(true); setStatus('Obteniendo Ã¡reaâ€¦', 20);
  clearMarkers(); STATE.feats=[];

  try{
    const tags = KEYMAP[strip(norm(tipo))] || null;
    let bbox = null;
    try{ if(muni){ bbox = await fetchBBoxByName(muni); } }catch(e){ console.warn('bbox municipio fallÃ³', e); }
    if(!bbox){ bbox = await fetchBBoxByName(prov); }

    let ql = tags ? qlByBBoxTags(tags, bbox, rapido) : qlByBBoxName(tipo, bbox, rapido);
    STATE.lastQL = ql; document.getElementById('ql').value = ql;
    setStatus('Consultando Overpassâ€¦', 55);
    let data = await overpassTryAll(ql);
    let added = useableCount(data);

    if(!added){
      const big = expandBBox(bbox, 0.28);
      ql = tags ? qlByBBoxTags(tags, big, rapido) : qlByBBoxName(tipo, big, rapido);
      STATE.lastQL = ql; document.getElementById('ql').value = ql;
      setStatus('Ampliando Ã¡reaâ€¦', 72);
      data = await overpassTryAll(ql);
      added = useableCount(data);
    }

    pushResults(data);

    const tb = document.querySelector('#tbl tbody'); tb.innerHTML=''; let bounds=[];
    STATE.feats.forEach(f=>{
      const tr=document.createElement('tr');
      tr.innerHTML = `<td>${f.name||''}</td><td>${f.tipo||''}</td><td>${f.address||''}</td><td>${f.phone||''}</td><td>${f.website?`<a href="${f.website}" target="_blank" rel="noopener">link</a>`:''}</td><td>${f.lat.toFixed(6)}</td><td>${f.lon.toFixed(6)}</td>`;
      tr.style.cursor='pointer'; tr.addEventListener('click',()=>STATE.map.setView([f.lat,f.lon],17));
      tb.appendChild(tr);
      addMarker(f.lat,f.lon,f); bounds.push([f.lat,f.lon]);
    });
    document.getElementById('statCount').textContent = STATE.feats.length;
    if(bounds.length){ STATE.map.fitBounds(bounds,{padding:[20,20]}); }
    setStatus(STATE.feats.length? 'Completado' : 'Sin resultados', 100);
    if(!STATE.feats.length){ showErr('Sin datos en OSM para ese tÃ©rmino/Ã¡rea.'); }
    else showOk('Listo (usÃ³: '+(STATE.lastServer||'')+')');
  }catch(e){ console.error(e); showErr('Overpass/CORS: '+(e.message||e)); }
  finally{ setBusy(false); setTimeout(()=>{document.getElementById('pbar').style.width='0%'; document.getElementById('status').textContent='Listo';},900); }
}

function toCSV(rows, headers){ const head=headers.join(','); const esc=v=>{if(v==null) return ''; const s=String(v); return (s.includes(',')||s.includes('\"')||s.includes('\\n'))?('\"'+s.replace(/\"/g,'\"\"')+'\"'):s;}; const body=rows.map(r=>headers.map(h=>esc(r[h])).join(',')).join('\\n'); return head+'\\n'+body; }
document.addEventListener('DOMContentLoaded', ()=>{
  initMap();
  const selP=document.getElementById('selProv'); selP.innerHTML='<option value="">(seleccione)</option>'+PROVINCIAS.map(p=>`<option value="${p}">${p}</option>`).join('');
  selP.addEventListener('change',()=>{const l=MUNICIPIOS[selP.value]||[]; document.getElementById('selMuni').innerHTML='<option value="">(todos)</option>'+l.map(n=>`<option value="${n}">${n}</option>`).join(''); });
  document.getElementById('btnBuscar').addEventListener('click', buscar);
  document.getElementById('btnCSV').addEventListener('click', ()=>{ if(!STATE.feats.length) return showErr('No hay resultados.'); const csv=toCSV(STATE.feats,['name','tipo','address','phone','website','lat','lon']); const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'})); a.download='negocios_rd.csv'; a.click(); });
  document.getElementById('btnVerQL').addEventListener('click',()=>{ const t=document.getElementById('ql'); t.style.display = (t.style.display==='none'||t.style.display==='')?'block':'none'; t.value=STATE.lastQL||'(AÃºn no generada)'; });
  document.getElementById('btnDemo').addEventListener('click',()=>{ document.getElementById('qTipo').value='farmacia'; selP.value='Santo Domingo'; document.getElementById('selMuni').innerHTML='<option value="">(todos)</option>'+MUNICIPIOS['Santo Domingo'].map(n=>`<option value="${n}">${n}</option>`).join(''); buscar(); });
});
</script>
</body>
</html>
